---
########################################################################################################################
########################################################################################################################
# Description: Vector config file for:
#  - /usr/sap/*/*/*/trace/backup.log
#
# Vector Output Name: sap_trace_backup__out
#
# Last Updated & Tested: 2022/02/03
########################################################################################################################
########################################################################################################################
tests:
  - name: sap.hana.trace.backup::1
    inputs:
      - insert_at: backup__sap_hana_metadata
        type: log
        log_fields:
          message: |
            2021-03-24T02:15:54+00:00  P0123235      17862042eaa INFO    BACKUP   progress of service: nameserver, s001dbhrd:30001, volume: 1, 82% 2147483648/2617245696
    outputs:
      - extract_from: sap_hana_logs__out
        conditions:
          - type: vrl
            source: |
              assert!(is_timestamp(.timestamp))
              assert_eq!(parse_timestamp!("2021-03-24T02:15:54+00:00", "%Y-%m-%dT%H:%M:%S%:z"), .timestamp, "timestamp parsing incorrect")
...
