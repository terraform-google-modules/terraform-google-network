# {{- $customer := trimSuffix "-sftp" .Values.sftpgo.fullnameOverride }}
kind: Secret
apiVersion: v1
metadata:
  name: global-pqsql-secret
  annotations:
    argocd.argoproj.io/hook: PreSync
    argocd.argoproj.io/sync-wave: "-2"
    helm.sh/hook: pre-install
    argocd.argoproj.io/hook-delete-policy: HookSucceeded
    avp.kubernetes.io/path: "{{ .Values.vaultBasePath }}/global/pgsql"
type: Opaque
stringData:
  G_PSQL_USERNAME: <USERNAME>
  G_PSQL_PASSWORD: <PASSWORD>
  PSQL_HOST: <HOST>
  PSQL_PORT: <PORT>
  PSQL_USER: "{{ printf "%sadmin" ($customer | replace "-" "_") }}"
  PSQL_PASS: "{{ randAlphaNum 16 }}"
  PSQL_DB: "{{ default (printf "%sdb" ($customer | replace "-" "_")) .Values.dbName }}"
  DEFAULT_ADMIN_PASSWORD: "{{ randAlphaNum 16 }}"
  SIGNING_PASSPHRASE: "{{ randAlphaNum 18 }}"