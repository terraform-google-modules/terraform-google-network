{{- $customer := trimSuffix "-sftp" .Values.sftpgo.fullnameOverride }}
kind: Secret
apiVersion: v1
metadata:
  name: vault-config-secret
  annotations:
    argocd.argoproj.io/hook: PreSync
    argocd.argoproj.io/sync-wave: "-2"
    helm.sh/hook: pre-install
    argocd.argoproj.io/hook-delete-policy: HookSucceeded
    avp.kubernetes.io/path: "{{ .Values.vaultBasePath }}/global/vault"
type: Opaque
stringData:
  VAULT_ROLE_ID: <ROLE_ID>
  VAULT_SECRET_ID: <SECRET_ID>
  VAULT_ADDR: <VAULT_ADDR>
  VAULT_PATH: "{{ default (printf "%s/%s/sftp" .Values.vaultBasePath $customer) .Values.vaultPath }}"
